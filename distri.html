<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Annual Corporate Distribution List</title>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        h1 {
            text-align: center;
            background-color: #0075B4;
            color: white;
            padding: 10px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #0075B4;
            color: white;
        }
        .category-header {
            background-color: #f0f8ff;
            font-weight: bold;
        }
        .buttons {
            text-align: center;
            margin-top: 20px;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            font-size: 16px;
            cursor: pointer;
        }
        button:hover {
            background-color: #f0f0f0;
        }
        .input-field {
            width: 100%;
            border: none;
            outline: none;
        }
        .totals-row {
            background-color: #d1ecf1;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>Annual Corporate Distribution List</h1>
    <form id="distributionForm">
        <table>
            <thead>
                <tr>
                    <th>No.</th>
                    <th>Company</th>
                    <th>Recipient / Name</th>
                    <th>Designation</th>
                    <th colspan="3" class="category-header">Category 1</th>
                    <th colspan="3" class="category-header">Category 2</th>
                </tr>
                <tr>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th>Type A</th>
                    <th>Type B</th>
                    <th>Type C</th>
                    <th>Type A</th>
                    <th>Type B</th>
                    <th>Type C</th>
                </tr>
            </thead>
            <tbody id="dataRows">
                <tr>
                    <td><input type="text" class="input-field" name="no[]"></td>
                    <td><input type="text" class="input-field" name="company[]"></td>
                    <td><input type="text" class="input-field" name="recipient[]"></td>
                    <td><input type="text" class="input-field" name="designation[]"></td>
                    <td><input type="text" class="input-field" name="category1TypeA[]"></td>
                    <td><input type="text" class="input-field" name="category1TypeB[]"></td>
                    <td><input type="text" class="input-field" name="category1TypeC[]"></td>
                    <td><input type="text" class="input-field" name="category2TypeA[]"></td>
                    <td><input type="text" class="input-field" name="category2TypeB[]"></td>
                    <td><input type="text" class="input-field" name="category2TypeC[]"></td>
                </tr>
            </tbody>
        </table>
        <table>
            <tr class="totals-row">
                <td colspan="5">Total Initial Request (AE Name):</td>
                <td colspan="5"><input type="text" class="input-field" name="initialRequest"></td>
            </tr>
            <tr class="totals-row">
                <td colspan="5">Add: Contingency</td>
                <td colspan="5"><input type="text" class="input-field" name="contingency"></td>
            </tr>
            <tr class="totals-row">
                <td colspan="5">Overall Total</td>
                <td colspan="5"><input type="text" class="input-field" name="overallTotal"></td>
            </tr>
        </table>
        <div class="buttons">
          <!--  <button type="button" onclick="saveToLocal()">Save to Local</button>-->
            <button type="button" onclick="window.print()">Print</button>
            <button type="reset">Clear</button>
            <button type="button" onclick="saveAsExcel()">Save as Excel</button>
        </div>
    </form>

  <script>
    //function saveToLocal() {
          //  const formData = new FormData(document.getElementById('distributionForm'));
          //  const formObject = Object.fromEntries(formData.entries());
          //  localStorage.setItem('distributionForm', JSON.stringify(formObject));
          //  alert('Form data saved locally!');
  

        function saveAsExcel() {
            // Extract data from the form
            const tableData = [];
            const headers = [
                "No.",
                "Company",
                "Recipient / Name",
                "Designation",
                "Category 1 (Type A)",
                "Category 1 (Type B)",
                "Category 1 (Type C)",
                "Category 2 (Type A)",
                "Category 2 (Type B)",
                "Category 2 (Type C)"
            ];
            tableData.push(headers);

            // Extract rows
            const rows = document.querySelectorAll("#dataRows tr");
            rows.forEach(row => {
                const rowData = Array.from(row.querySelectorAll("input")).map(input => input.value);
                tableData.push(rowData);
            });

            // Add totals row
            tableData.push(["", "", "", "", "Total Initial Request", "", "", "", "", document.querySelector("[name='initialRequest']").value]);
            tableData.push(["", "", "", "", "Add: Contingency", "", "", "", "", document.querySelector("[name='contingency']").value]);
            tableData.push(["", "", "", "", "Overall Total", "", "", "", "", document.querySelector("[name='overallTotal']").value]);

            // Create worksheet
            const worksheet = XLSX.utils.aoa_to_sheet(tableData);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, "Distribution List");

            // Save file
            XLSX.writeFile(workbook, "Distribution_List.xlsx");
            alert("Excel file has been saved!");
        }
    </script>
</body>
</html>
